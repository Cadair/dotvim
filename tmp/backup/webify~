#!/bin/bash
filepath=$1
# file may or may not have .extension
filename=$(basename ${filepath})
short_filename=${filename%.*}

# where is the webpage input dir?
input_dir=/home/eeaol/web/input/blog

# get the date from the file, assuming dd/mm/yyyy format and
# converting to yyyy-mm-dd
date=$(grep '[0-9]./[0-9]./[0-9]...' $filename |\
        sed -e 's/^[^0-9]*//' \
            -e 's/\(..\)\/\(..\)\/\(....\)/\3-\2-\1/')


newfilepath=${input_dir}/blog.${date}.${short_filename}.md
cp $filepath $newfilepath

# add the --- to the start of the file
echo "---" >> tmpf
cat $newfilepath >> tmpf
mv tmpf $newfilepath
rm -f tmpf

